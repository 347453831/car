<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fengf.carrental.dao.OrderDao">
    <sql id="Base_Column_List">
        order_id,
        order_no,
        order_name,
        order_phone,
        order_car,
        order_starttime,
        order_endtime,
        order_stores,
        order_return,
        order_price,
        order_sumprice
    </sql>
    <resultMap id="BaseResultMap" type="com.fengf.carrental.entity.Order">
        <!--@Table order-->
        <result property="orderId" column="order_id" jdbcType="INTEGER"/>
        <result property="orderNo" column="order_no" jdbcType="VARCHAR"/>
        <result property="orderName" column="order_name" jdbcType="VARCHAR"/>
        <result property="orderPhone" column="order_phone" jdbcType="VARCHAR"/>
        <result property="orderCar" column="order_car" jdbcType="VARCHAR"/>
        <result property="orderStarttime" column="order_starttime" jdbcType="DATE"/>
        <result property="orderEndtime" column="order_endtime" jdbcType="DATE"/>
        <result property="orderStores" column="order_stores" jdbcType="VARCHAR"/>
        <result property="orderReturn" column="order_return" jdbcType="VARCHAR"/>
        <result property="orderPrice" column="order_price" jdbcType="NUMERIC"/>
        <result property="orderSumprice" column="order_sumprice" jdbcType="NUMERIC"/>
    </resultMap>

    <!--查询单个-->
    <select id="queryById" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from car.order
        where order_id = #{orderId}
    </select>

    <!--查询指定行数据-->
    <select id="queryAllByLimit" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from car.order
        limit #{offset}, #{limit}
    </select>

    <!--通过实体作为筛选条件查询-->
    <select id="queryAll" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from `order`
        WHERE order_return IS NULL
           OR TRIM(order_return) = '';
    </select>

    <!--新增所有列-->
    <insert id="insert" keyProperty="orderId" useGeneratedKeys="true">
        insert into car.order(order_no, order_name, order_phone, order_car, order_starttime, order_endtime,
                              order_stores, order_return, order_price, order_sumprice)
        values (#{orderNo}, #{orderName}, #{orderPhone}, #{orderCar}, #{orderStarttime}, #{orderEndtime},
                #{orderStores}, #{orderReturn}, #{orderPrice}, #{orderSumprice})
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update car.order
        <set>
            <if test="orderNo != null">
                order_no = #{orderNo},
            </if>
            <if test="orderName != null and orderName != ''">
                order_name = #{orderName},
            </if>
            <if test="orderPhone != null and orderPhone != ''">
                order_phone = #{orderPhone},
            </if>
            <if test="orderCar != null and orderCar != ''">
                order_car = #{orderCar},
            </if>
            <if test="orderStarttime != null">
                order_starttime = #{orderStarttime},
            </if>
            <if test="orderEndtime != null">
                order_endtime = #{orderEndtime},
            </if>
            <if test="orderStores != null and orderStores != ''">
                order_stores = #{orderStores},
            </if>
            <if test="orderReturn != null and orderReturn != ''">
                order_return = #{orderReturn},
            </if>
            <if test="orderPrice != null">
                order_price = #{orderPrice},
            </if>
            <if test="orderSumprice != null">
                order_sumprice = #{orderSumprice},
            </if>
        </set>
        where order_id = #{orderId}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete
        from `order` r
        where order_id = #{orderId}
    </delete>
    <!--auto generated by MybatisCodeHelper on 2020-10-29-->
    <select id="findOneByOrderNo" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from `order`
        where order_no = #{orderNo,jdbcType=VARCHAR}
    </select>
    <select id="selAllOrderByReturn" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from `order`
        where TRIM(order_return) != '';
    </select>
    <select id="selOrderByManyconditions" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM car.`order`
        WHERE order_name like "%"#{username,jdbcType=VARCHAR}"%" OR order_phone = #{phone,jdbcType=VARCHAR} OR (order_starttime >= #{startTime,jdbcType=DATE} AND order_endtime
         &lt; #{endTime,jdbcType=DATE})
    </select>
</mapper>
